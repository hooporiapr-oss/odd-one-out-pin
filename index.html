<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Akashic Odd One Out</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Georgia,serif;background:linear-gradient(135deg,#0a0e27,#1a1034,#2d1b4e);min-height:100vh;color:#e8e8f0;display:flex;flex-direction:column;align-items:center;padding:15px}
.title{font-size:2em;background:linear-gradient(135deg,#ffd700,#ff8c00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:5px}
.subtitle{color:#d4af37;margin-bottom:20px}
.box{background:rgba(255,255,255,0.05);border:2px solid rgba(212,175,55,0.5);border-radius:18px;padding:22px;width:100%;max-width:420px}
.hidden{display:none!important}
.banner{position:fixed;top:15px;right:15px;background:rgba(255,215,0,0.2);border:2px solid rgba(255,215,0,0.5);color:#ffd700;padding:8px 14px;border-radius:12px;font-size:0.85em}
.back{position:fixed;top:15px;left:15px;padding:8px 14px;background:rgba(255,255,255,0.1);border:2px solid rgba(212,175,55,0.3);border-radius:15px;color:#ffd700;text-decoration:none;font-size:0.85em}
.popup-bg{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;justify-content:center;align-items:center;z-index:5000;padding:20px}
.popup{background:linear-gradient(135deg,#1a1034,#2d1b4e);border:2px solid rgba(255,215,0,0.3);border-radius:18px;padding:25px;max-width:300px;text-align:center}
.popup-emoji{font-size:2.5em;margin-bottom:10px}
.popup h3{color:#e8e8f0;margin-bottom:5px}
.popup p{color:#a0a0b8;font-size:0.9em;margin-bottom:20px}
.popup a{display:block;padding:12px;background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.2);border-radius:10px;color:#e8e8f0;text-decoration:none;margin-bottom:15px}
.popup button{width:100%;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a1034;border:none;padding:12px;border-radius:20px;font-weight:bold;cursor:pointer}
.pin-title{color:#ffd700;font-size:1.3em;text-align:center;margin-bottom:8px}
.pin-sub{color:#b8b8cc;text-align:center;margin-bottom:20px;font-size:0.9em}
.dots{display:flex;justify-content:center;gap:12px;margin-bottom:20px}
.dot{width:16px;height:16px;border-radius:50%;border:2px solid rgba(212,175,55,0.5)}
.dot.on{background:#ffd700;border-color:#ffd700}
.keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;max-width:220px;margin:0 auto 15px}
.key{aspect-ratio:1;font-size:1.4em;border:2px solid rgba(212,175,55,0.3);background:rgba(255,255,255,0.05);color:#e8e8f0;border-radius:10px;cursor:pointer}
.key:active{transform:scale(0.95)}
.key.empty{visibility:hidden}
.msg{text-align:center;min-height:20px;font-size:0.9em}
.msg.err{color:#ff6b6b}
.msg.ok{color:#4ecdc4}
.toggle{text-align:center;margin-top:18px;color:#b8b8cc;font-size:0.9em}
.toggle span{color:#ffd700;cursor:pointer;text-decoration:underline}
.btn{width:100%;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a1034;border:none;padding:14px;border-radius:22px;font-size:1em;font-weight:bold;cursor:pointer;margin-top:8px}
.btn:hover{box-shadow:0 5px 20px rgba(255,215,0,0.5)}
.btn2{background:linear-gradient(135deg,#8a2be2,#4b0082);color:#fff}
.welcome{background:rgba(255,215,0,0.1);border:2px solid rgba(255,215,0,0.3);border-radius:12px;padding:15px;margin-bottom:15px;text-align:center}
.welcome h3{color:#ffd700;margin-bottom:5px}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin:15px 0}
.stat{background:rgba(255,255,255,0.05);padding:12px;border-radius:10px;text-align:center;border:1px solid rgba(212,175,55,0.2)}
.stat b{display:block;font-size:1.5em;color:#ffd700}
.stat span{color:#b8b8cc;font-size:0.75em}
.hdr{display:flex;justify-content:space-between;padding:10px;background:rgba(255,255,255,0.05);border-radius:10px;margin-bottom:10px}
.hdr div{text-align:center}
.hdr b{color:#ffd700;font-size:1.2em}
.hdr span{color:#b8b8cc;font-size:0.65em;display:block}
.lives{text-align:center;margin-bottom:8px;font-size:1.3em}
.lives .lost{opacity:0.3}
.lvl{text-align:center;background:rgba(138,43,226,0.2);padding:5px 12px;border-radius:15px;color:#d4af37;font-size:0.85em;margin-bottom:10px;display:inline-block}
.grid-wrap{background:rgba(0,0,0,0.3);border-radius:12px;padding:10px;margin-bottom:10px;border:2px solid rgba(212,175,55,0.3);text-align:center}
.grid{display:inline-grid;gap:5px}
.cell{aspect-ratio:1;border-radius:6px;cursor:pointer;transition:transform 0.1s}
.cell:hover{transform:scale(1.08)}
.cell:active{transform:scale(0.94)}
.cell.yes{animation:pop 0.4s}
.cell.no{animation:shake 0.3s}
@keyframes pop{50%{transform:scale(1.2)}}
@keyframes shake{25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}
.fb{text-align:center;min-height:22px;margin-bottom:8px}
.fb.g{color:#2ecc71}
.fb.r{color:#e74c3c}
.res-bg{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;justify-content:center;align-items:center;z-index:3000;padding:20px}
.res{background:linear-gradient(135deg,#1a1034,#2d1b4e);border:3px solid #ffd700;border-radius:20px;padding:28px 20px;max-width:350px;width:100%;text-align:center;animation:zoomIn 0.3s}
@keyframes zoomIn{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}
.res-icon{font-size:3em;margin-bottom:10px}
.res h2{color:#ffd700;margin-bottom:10px}
.res-score{font-size:3em;color:#ffd700;font-weight:bold}
.res-label{color:#b8b8cc;margin-bottom:15px}
.res-stats{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:15px}
.res-stat{background:rgba(255,255,255,0.05);padding:10px;border-radius:8px}
.res-stat b{color:#ffd700;font-size:1.3em;display:block}
.res-stat span{color:#b8b8cc;font-size:0.7em}
.record{background:rgba(255,215,0,0.2);border:2px solid #ffd700;border-radius:8px;padding:10px;margin:12px 0;color:#ffd700;font-weight:bold}
.rating{color:#d4af37;margin-bottom:15px}
@media(max-width:500px){.back,.banner{position:relative;top:auto;left:auto;right:auto;margin:0 5px 10px;display:inline-block}}
</style>
</head>
<body>
<a href="https://hooporiapr-oss.github.io/akashic-works/" class="back">‚Üê Home</a>
<div class="title">üé™ Odd One Out</div>
<div class="subtitle">Spot the Difference</div>

<div class="box" id="loginBox">
<div class="pin-title">Enter PIN</div>
<div class="pin-sub">Enter your 4-digit PIN</div>
<div class="dots"><div class="dot" id="d1"></div><div class="dot" id="d2"></div><div class="dot" id="d3"></div><div class="dot" id="d4"></div></div>
<div class="keypad" id="loginPad"></div>
<div class="msg" id="loginMsg"></div>
<div class="toggle">No account? <span id="toCreate">Create PIN</span></div>
</div>

<div class="box hidden" id="createBox">
<div class="pin-title" id="createTitle">Create PIN</div>
<div class="pin-sub" id="createSub">Choose a 4-digit PIN</div>
<div class="dots"><div class="dot" id="c1"></div><div class="dot" id="c2"></div><div class="dot" id="c3"></div><div class="dot" id="c4"></div></div>
<div class="keypad" id="createPad"></div>
<div class="msg" id="createMsg"></div>
<div class="toggle">Have a PIN? <span id="toLogin">Login</span></div>
</div>

<div class="box hidden" id="dashBox">
<div class="welcome"><h3>Welcome! üé™</h3><p style="color:#b8b8cc">Find the different one</p></div>
<div class="stats">
<div class="stat"><b id="dGames">0</b><span>Games</span></div>
<div class="stat"><b id="dBest">--</b><span>Best Level</span></div>
<div class="stat"><b id="dScore">--</b><span>Best Score</span></div>
<div class="stat"><b id="dRate">--</b><span>Rating</span></div>
</div>
<button class="btn" id="startBtn">üé™ Start Game</button>
<button class="btn btn2" id="logoutBtn">Logout</button>
</div>

<div class="box hidden" id="gameBox">
<div class="hdr">
<div><b id="gLevel">1</b><span>LEVEL</span></div>
<div><b id="gScore">0</b><span>SCORE</span></div>
<div><b id="gTime">10</b><span>TIME</span></div>
</div>
<div class="lives" id="livesBox">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
<div class="grid-wrap"><div class="grid" id="grid"></div></div>
<div class="fb" id="fb">Find the odd one!</div>
<button class="btn btn2" id="quitBtn">‚Üê Quit</button>
</div>

<div class="res-bg hidden" id="resBg">
<div class="res">
<div class="res-icon" id="resIcon">üé™</div>
<h2>Game Over!</h2>
<div class="res-score" id="resScore">0</div>
<div class="res-label">Score</div>
<div class="res-stats">
<div class="res-stat"><b id="resLevel">1</b><span>Level Reached</span></div>
<div class="res-stat"><b id="resCorrect">0</b><span>Correct</span></div>
</div>
<div class="record hidden" id="resRecord">üèÜ New Record!</div>
<div class="rating" id="resRating">Rating: --</div>
<button class="btn" id="againBtn">üîÑ Play Again</button>
<button class="btn btn2" id="menuBtn">Menu</button>
</div>
</div>

<div class="popup-bg hidden" id="limitPopup">
<div class="popup">
<div class="popup-emoji">‚è∏Ô∏è</div>
<h3>Daily limit reached</h3>
<p>You've used 3 free plays today</p>
<a href="https://hooporiapr-oss.github.io/akashic-works/">Return Home</a>
<button id="upgradeBtn">Unlock Unlimited</button>
</div>
</div>

<script>
var PK="odd_pin",SK="odd_stats",TK="odd_tries",MAX=3;
function hash(p){var h=0,s=p+"odd24";for(var i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h&=h;}return h.toString(36);}
function hasPin(){return!!localStorage.getItem(PK);}
function checkPin(p){return localStorage.getItem(PK)===hash(p);}
function savePin(p){localStorage.setItem(PK,hash(p));localStorage.setItem(SK,JSON.stringify({games:0,bestLvl:0,bestScore:0}));}
function getStats(){var s=localStorage.getItem(SK);return s?JSON.parse(s):{games:0,bestLvl:0,bestScore:0};}
function setStats(s){localStorage.setItem(SK,JSON.stringify(s));}
function getTries(){var t=localStorage.getItem(TK);if(!t)return{n:0,d:new Date().toDateString()};return JSON.parse(t);}
function setTries(t){localStorage.setItem(TK,JSON.stringify(t));}
function canPlay(){var t=getTries();if(t.d!==new Date().toDateString()){t.n=0;t.d=new Date().toDateString();}setTries(t);return{ok:t.n<MAX,left:MAX-t.n};}
function useTry(){var t=getTries();if(t.d!==new Date().toDateString()){t.n=0;t.d=new Date().toDateString();}t.n++;setTries(t);showBanner();}
function showBanner(){var c=canPlay(),old=document.querySelector(".banner");if(old)old.remove();var b=document.createElement("div");b.className="banner";b.textContent="üéÆ "+c.left+" free "+(c.left===1?"try":"tries");document.body.appendChild(b);}
function showLimit(){document.getElementById("limitPopup").classList.remove("hidden");}
function show(id){["loginBox","createBox","dashBox","gameBox"].forEach(function(x){document.getElementById(x).classList.add("hidden");});document.getElementById(id).classList.remove("hidden");}
function dots(pre,n){for(var i=1;i<=4;i++){var d=document.getElementById(pre+i);if(d)d.classList.toggle("on",i<=n);}}
function msg(id,t,e){var m=document.getElementById(id);m.textContent=t;m.className="msg "+(e?"err":"ok");}

var loginPin="",createPin="",confirmPin="",confirming=false;
function buildPad(id,onNum,onDel){
var pad=document.getElementById(id);pad.innerHTML="";
for(var i=1;i<=9;i++){var k=document.createElement("button");k.className="key";k.textContent=i;k.onclick=(function(n){return function(){onNum(n);};})(i);pad.appendChild(k);}
var empty=document.createElement("button");empty.className="key empty";pad.appendChild(empty);
var zero=document.createElement("button");zero.className="key";zero.textContent="0";zero.onclick=function(){onNum(0);};pad.appendChild(zero);
var del=document.createElement("button");del.className="key";del.textContent="‚å´";del.onclick=onDel;pad.appendChild(del);
}
function initLogin(){
buildPad("loginPad",function(n){
if(loginPin.length<4){loginPin+=n;dots("d",loginPin.length);
if(loginPin.length===4){setTimeout(function(){if(checkPin(loginPin)){loadDash();}else{msg("loginMsg","Wrong PIN",true);loginPin="";dots("d",0);}},200);}}
},function(){if(loginPin.length>0){loginPin=loginPin.slice(0,-1);dots("d",loginPin.length);document.getElementById("loginMsg").textContent="";}});
}
function initCreate(){
buildPad("createPad",function(n){
if(confirmPin.length<4){confirmPin+=n;dots("c",confirmPin.length);
if(confirmPin.length===4){setTimeout(function(){
if(!confirming){createPin=confirmPin;confirmPin="";confirming=true;document.getElementById("createTitle").textContent="Confirm PIN";document.getElementById("createSub").textContent="Enter PIN again";dots("c",0);}
else{if(confirmPin===createPin){savePin(createPin);msg("createMsg","PIN created!",false);setTimeout(loadDash,500);}else{msg("createMsg","PINs don't match",true);createPin="";confirmPin="";confirming=false;document.getElementById("createTitle").textContent="Create PIN";document.getElementById("createSub").textContent="Choose a 4-digit PIN";dots("c",0);}}
},200);}}
},function(){if(confirmPin.length>0){confirmPin=confirmPin.slice(0,-1);dots("c",confirmPin.length);document.getElementById("createMsg").textContent="";}});
}
function loadDash(){
var s=getStats();
document.getElementById("dGames").textContent=s.games;
document.getElementById("dBest").textContent=s.bestLvl||"--";
document.getElementById("dScore").textContent=s.bestScore||"--";
document.getElementById("dRate").textContent=getRating(s.bestScore);
show("dashBox");showBanner();
if(!canPlay().ok)showLimit();
}
function getRating(sc){if(!sc)return"--";if(sc>=50)return"üß† Genius";if(sc>=30)return"‚≠ê Master";if(sc>=18)return"üî• Expert";if(sc>=10)return"üëç Good";return"üìö Learning";}

var level=1,score=0,lives=3,correct=0,oddIdx=-1,timer=null,timeLeft=10,gameOn=false;
var colors=["#e74c3c","#3498db","#2ecc71","#f1c40f","#9b59b6","#1abc9c","#e67e22","#34495e","#e91e63","#00bcd4"];

function startGame(){
if(!canPlay().ok){showLimit();return;}
level=1;score=0;lives=3;correct=0;gameOn=true;
document.getElementById("resBg").classList.add("hidden");
show("gameBox");
nextRound();
}
function nextRound(){
if(!gameOn)return;
updateUI();
genGrid();
timeLeft=Math.max(4,12-level);
document.getElementById("gTime").textContent=timeLeft;
document.getElementById("fb").textContent="Find the odd one!";
document.getElementById("fb").className="fb";
clearInterval(timer);
timer=setInterval(function(){
timeLeft--;document.getElementById("gTime").textContent=timeLeft;
if(timeLeft<=0){clearInterval(timer);loseLife();}
},1000);
}
function updateUI(){
document.getElementById("gLevel").textContent=level;
document.getElementById("gScore").textContent=score;
var h="";for(var i=0;i<3;i++)h+="<span class='"+(i<lives?"":"lost")+"'>‚ù§Ô∏è</span>";
document.getElementById("livesBox").innerHTML=h;
}
function genGrid(){
var size=Math.min(3+Math.floor(level/3),7);
var grid=document.getElementById("grid");
grid.innerHTML="";
grid.style.gridTemplateColumns="repeat("+size+",1fr)";
var cellSize=Math.floor(280/size)+"px";
var total=size*size;
oddIdx=Math.floor(Math.random()*total);
var baseColor=colors[Math.floor(Math.random()*colors.length)];
var oddColor=shiftColor(baseColor,Math.max(8,40-level*3));
for(var i=0;i<total;i++){
var cell=document.createElement("div");
cell.className="cell";
cell.style.width=cellSize;
cell.style.height=cellSize;
cell.style.background=i===oddIdx?oddColor:baseColor;
cell.dataset.idx=i;
cell.onclick=function(){pickCell(this);};
grid.appendChild(cell);
}
}
function shiftColor(hex,amt){
var r=parseInt(hex.slice(1,3),16),g=parseInt(hex.slice(3,5),16),b=parseInt(hex.slice(5,7),16);
var dir=Math.random()>0.5?1:-1;
r=Math.min(255,Math.max(0,r+dir*amt));
g=Math.min(255,Math.max(0,g+dir*amt));
return"#"+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1);
}
function pickCell(cell){
if(!gameOn)return;
clearInterval(timer);
var idx=parseInt(cell.dataset.idx);
if(idx===oddIdx){
cell.classList.add("yes");
score+=level;correct++;
document.getElementById("fb").textContent="‚úì Correct! +"+level;
document.getElementById("fb").className="fb g";
level++;
setTimeout(nextRound,600);
}else{
cell.classList.add("no");
document.getElementById("fb").textContent="‚úó Wrong!";
document.getElementById("fb").className="fb r";
loseLife();
}
}
function loseLife(){
lives--;updateUI();
if(lives<=0){endGame();}
else{setTimeout(nextRound,800);}
}
function endGame(){
gameOn=false;clearInterval(timer);
var s=getStats();s.games++;
var isRecord=score>s.bestScore;
if(score>s.bestScore)s.bestScore=score;
if(level-1>s.bestLvl)s.bestLvl=level-1;
setStats(s);useTry();
document.getElementById("resScore").textContent=score;
document.getElementById("resLevel").textContent=level-1;
document.getElementById("resCorrect").textContent=correct;
document.getElementById("resRating").textContent="Rating: "+getRating(score);
document.getElementById("resRecord").classList.toggle("hidden",!isRecord);
document.getElementById("resIcon").textContent=score>=30?"üèÜ":score>=15?"‚≠ê":"üé™";
document.getElementById("resBg").classList.remove("hidden");
if(!canPlay().ok)setTimeout(showLimit,1500);
}

document.addEventListener("DOMContentLoaded",function(){
initLogin();initCreate();
document.getElementById("toCreate").onclick=function(){createPin="";confirmPin="";confirming=false;document.getElementById("createTitle").textContent="Create PIN";document.getElementById("createSub").textContent="Choose a 4-digit PIN";dots("c",0);document.getElementById("createMsg").textContent="";show("createBox");};
document.getElementById("toLogin").onclick=function(){loginPin="";dots("d",0);document.getElementById("loginMsg").textContent="";show("loginBox");};
document.getElementById("startBtn").onclick=function(){if(!canPlay().ok){showLimit();return;}startGame();};
document.getElementById("logoutBtn").onclick=function(){loginPin="";dots("d",0);show("loginBox");};
document.getElementById("quitBtn").onclick=function(){gameOn=false;clearInterval(timer);loadDash();};
document.getElementById("againBtn").onclick=function(){if(!canPlay().ok){document.getElementById("resBg").classList.add("hidden");showLimit();return;}startGame();};
document.getElementById("menuBtn").onclick=function(){document.getElementById("resBg").classList.add("hidden");loadDash();};
document.getElementById("upgradeBtn").onclick=function(){location.href="mailto:support@akashic.works?subject=Pro%20Upgrade";};
if(hasPin())show("loginBox");else show("createBox");
});
</script>
</body>
</html>
